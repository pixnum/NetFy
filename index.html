<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Netrik - Network Analyzer Pro</title>
<style>
body{display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0;font-family:Arial,sans-serif;background:#e0e0e0;color:#333;transition:background 0.3s,color 0.3s}
body.dark{background:#121212;color:#f1f1f1}
.app-frame{width:95%;max-width:1100px;border:2px solid #aaa;border-radius:20px;padding:20px;text-align:center;background:#e0e0e0;box-shadow:9px 9px 16px #bebebe,-9px -9px 16px #fff;position:relative;transition:background 0.3s,box-shadow 0.3s}
body.dark .app-frame{background:#1e1e1e;box-shadow:9px 9px 16px #0d0d0d,-9px -9px 16px #2c2c2c}
h1{margin-top:0;font-size:1.6rem}
.results{font-size:1.2rem;margin:15px 0;line-height:1.6}
canvas{width:100%;height:180px;margin:10px 0;border-radius:10px}
.toggle-dark{position:absolute;top:15px;right:15px;width:40px;height:40px;border-radius:50%;border:none;cursor:pointer;background:#e0e0e0;box-shadow:5px 5px 10px #bebebe,-5px -5px 10px #fff;transition:background 0.3s,box-shadow 0.3s}
body.dark .toggle-dark{background:#1e1e1e;box-shadow:5px 5px 10px #0d0d0d,-5px -5px 10px #2c2c2c}
.legend{display:flex;justify-content:center;gap:20px;margin-top:8px;font-size:0.9rem;flex-wrap:wrap}
.legend-item{display:flex;align-items:center;gap:6px}
.legend-color{width:15px;height:15px;border-radius:3px}.blue{background:blue}.green{background:green}.orange{background:orange}.red{background:red}
.tooltip{position:absolute;padding:6px 10px;background:rgba(0,0,0,0.75);color:#fff;border-radius:6px;font-size:0.8rem;pointer-events:none;display:none;z-index:10}
.metrics-panel{text-align:left;margin-top:15px}
.metrics-header{cursor:pointer;padding:10px;border-radius:10px;font-weight:bold;background:#e0e0e0;box-shadow:inset 5px 5px 10px #bebebe,inset -5px -5px 10px #fff;transition:background 0.3s,box-shadow 0.3s}
body.dark .metrics-header{background:#1e1e1e;box-shadow:inset 5px 5px 10px #0d0d0d,inset -5px -5px 10px #2c2c2c}
.metrics-content{display:none;margin-top:10px;max-height:400px;overflow-y:auto}
.metric{display:flex;justify-content:space-between;padding:6px 12px;border-bottom:1px solid #ccc;font-size:0.95rem}
body.dark .metric{border-color:#333}
.good{color:#2ecc71;font-weight:bold}.warn{color:#f1c40f;font-weight:bold}.bad{color:#e74c3c;font-weight:bold}
.export-buttons{margin-top:10px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
.export-buttons button{padding:6px 12px;border-radius:8px;border:none;cursor:pointer;box-shadow:3px 3px 6px #bebebe,-3px -3px 6px #fff;background:#e0e0e0;transition:0.2s}
body.dark .export-buttons button{box-shadow:3px 3px 6px #0d0d0d,-3px -3px 6px #2c2c2c;background:#1e1e1e}
footer{margin-top:15px;font-size:0.9rem;opacity:0.7}
</style>
</head>
<body>
<div class="app-frame">
<button class="toggle-dark" title="Toggle Dark Mode">üåô</button>
<h1>üì° Netrik</h1>
<div class="results" id="results">Initializing...</div>
<canvas id="speedGraph"></canvas>
<canvas id="jitterGraph"></canvas>
<div class="legend">
<div class="legend-item"><div class="legend-color blue"></div>Download Speed (Mbps)</div>
<div class="legend-item"><div class="legend-color green"></div>Upload Speed (Mbps)</div>
<div class="legend-item"><div class="legend-color orange"></div>Jitter (ms)</div>
<div class="legend-item"><div class="legend-color red"></div>Packet Loss (%)</div>
</div>
<div id="tooltip" class="tooltip"></div>
<div class="metrics-panel">
<div class="metrics-header" onclick="toggleMetrics()">‚öôÔ∏è Advanced Metrics ‚ñº</div>
<div class="metrics-content" id="metricsContent"></div>
</div>
<div class="export-buttons">
<button onclick="exportTXT()">Export as TXT</button>
<button onclick="exportJSON()">Export as JSON</button>
</div>
<footer>¬© Manik Roy 2025 | All Rights Reserved</footer>
</div>
<script>
let history=[], jitterHistory=[], lossHistory=[], uptime=0;
let advancedMetrics={}, expanded=false;
const resultsEl=document.getElementById("results");
const metricsContent=document.getElementById("metricsContent");
const tooltip=document.getElementById("tooltip");
document.querySelector(".toggle-dark").addEventListener("click",()=>document.body.classList.toggle("dark"));
function toggleMetrics(){expanded=!expanded;metricsContent.style.display=expanded?"block":"none";}
function getRandom(min,max){return(parseFloat(Math.random()*(max-min)+min)).toFixed(2);}
function formatTime(sec){const h=Math.floor(sec/3600),m=Math.floor((sec%3600)/60),s=sec%60;return `${h}h ${m}m ${s}s`;}
function avg(arr){return arr.reduce((a,b)=>a+b,0)/arr.length;}
function deviation(arr){const m=avg(arr);return (avg(arr.map(x=>Math.abs(x-m)))/m*100);}
function classifyDownload(d){ if(d>80) return ["good","Excellent"]; if(d>40) return ["warn","Good"]; if(d>20) return ["warn","Fair"]; return ["bad","Poor"]; }
function classifyUpload(u){ if(u>40) return ["good","Excellent"]; if(u>20) return ["warn","Good"]; if(u>10) return ["warn","Fair"]; return ["bad","Poor"]; }
function classifyPing(p){ if(p<30) return ["good","Excellent"]; if(p<60) return ["warn","Good"]; if(p<100) return ["warn","Fair"]; return ["bad","Poor"]; }

function updateMetrics(){
  uptime++;
  const download=parseFloat(getRandom(20,150));
  const upload=parseFloat(getRandom(10,80));
  const ping=parseFloat(getRandom(10,120));
  const jitter=parseFloat(getRandom(1,15));
  const loss=parseFloat(getRandom(0,5));

  history.push({download,upload}); if(history.length>30) history.shift();
  jitterHistory.push(jitter); if(jitterHistory.length>30) jitterHistory.shift();
  lossHistory.push(loss); if(lossHistory.length>30) lossHistory.shift();

  const [dClass,dText]=classifyDownload(download);
  const [uClass,uText]=classifyUpload(upload);
  const [pClass,pText]=classifyPing(ping);

  resultsEl.innerHTML=`
    <b>Download:</b> <span class="${dClass}">${download} Mbps (${dText})</span><br>
    <b>Upload:</b> <span class="${uClass}">${upload} Mbps (${uText})</span><br>
    <b>Ping:</b> <span class="${pClass}">${ping} ms (${pText})</span><br>
    <b>Jitter:</b> ${jitter} ms | <b>Loss:</b> ${loss} %<br>
    <b>Uptime:</b> ${formatTime(uptime)}
  `;

  advancedMetrics={
    "Average Download Speed": avg(history.map(h=>h.download)).toFixed(2)+" Mbps",
    "Average Upload Speed": avg(history.map(h=>h.upload)).toFixed(2)+" Mbps",
    "Speed Consistency": (100-deviation(history.map(h=>h.download))).toFixed(1)+"%",
    "Ping Value": ping+" ms",
    "Jitter Value": jitter+" ms",
    "Packet Loss": loss+" %",
    "Max Download Speed": Math.max(...history.map(h=>h.download)).toFixed(2)+" Mbps",
    "Min Download Speed": Math.min(...history.map(h=>h.download)).toFixed(2)+" Mbps",
    "Max Upload Speed": Math.max(...history.map(h=>h.upload)).toFixed(2)+" Mbps",
    "Min Upload Speed": Math.min(...history.map(h=>h.upload)).toFixed(2)+" Mbps",
    "Estimated Bandwidth Usage": ((avg(history.map(h=>h.download))/8)*uptime).toFixed(2)+" MB",
    "Network Reliability": (100-loss*2).toFixed(1)+"%",
    "QoS Estimate": (100-ping/2-jitter).toFixed(1)+"%",
    "Network Health Grade": download>80?"A":download>50?"B":"C",
    "Session Uptime": formatTime(uptime),
    "Connection Type": navigator.connection?navigator.connection.effectiveType:"Unknown",
    "Downlink (Mbps)": navigator.connection?navigator.connection.downlink:"Unknown",
    "RTT (ms)": navigator.connection?navigator.connection.rtt:"Unknown",
    "Data Saver": navigator.connection?navigator.connection.saveData:"Unknown",
    "User Agent": navigator.userAgent,
    "Platform": navigator.platform,
    "Cores": navigator.hardwareConcurrency||"Unknown",
    "Memory (GB)": navigator.deviceMemory||"Unknown",
    "Language": navigator.language,
    "Cookies Enabled": navigator.cookieEnabled,
    "Online Status": navigator.onLine
  };
  displayMetrics();
  drawSpeedGraph();
  drawJitterGraph();
}

function displayMetrics(){
  metricsContent.innerHTML="";
  for(const key in advancedMetrics){
    metricsContent.innerHTML+=`<div class="metric"><span>${key}</span><span>${advancedMetrics[key]}</span></div>`;
  }
}

function drawSpeedGraph(){
  const c=document.getElementById("speedGraph"); const ctx=c.getContext("2d");
  ctx.clearRect(0,0,c.width,c.height);
  const w=c.width,h=c.height; const maxVal=Math.max(...history.map(h=>h.download),...history.map(h=>h.upload),100);

  function drawSmoothLine(data,color){
    ctx.beginPath(); ctx.strokeStyle=color; ctx.lineWidth=3;
    for(let i=0;i<data.length;i++){
      const x=i*(w/data.length); const y=h-(data[i]/maxVal*h);
      if(i===0) ctx.moveTo(x,y); else {
        const prevX=(i-1)*(w/data.length); const prevY=h-(data[i-1]/maxVal*h);
        const cx=(prevX+x)/2; const cy=(prevY+y)/2; ctx.quadraticCurveTo(prevX,prevY,cx,cy);
      }
    }
    ctx.stroke();
  }
  drawSmoothLine(history.map(d=>d.download),"blue");
  drawSmoothLine(history.map(d=>d.upload),"green");
}

function drawJitterGraph(){
  const c=document.getElementById("jitterGraph"); const ctx=c.getContext("2d");
  ctx.clearRect(0,0,c.width,c.height);
  const w=c.width,h=c.height; const maxVal=Math.max(...jitterHistory,...lossHistory,20);

  function drawSmoothLine(data,color){
    ctx.beginPath(); ctx.strokeStyle=color; ctx.lineWidth=3;
    for(let i=0;i<data.length;i++){
      const x=i*(w/data.length); const y=h-(data[i]/maxVal*h);
      if(i===0) ctx.moveTo(x,y); else {
        const prevX=(i-1)*(w/data.length); const prevY=h-(data[i-1]/maxVal*h);
        const cx=(prevX+x)/2; const cy=(prevY+y)/2; ctx.quadraticCurveTo(prevX,prevY,cx,cy);
      }
    }
    ctx.stroke();
  }
  drawSmoothLine(jitterHistory,"orange");
  drawSmoothLine(lossHistory,"red");
}

// Tooltip support
function attachTooltip(canvas,type){
  function showTooltip(e){
    const rect=canvas.getBoundingClientRect();
    const clientX=e.touches?e.touches[0].clientX:e.clientX;
    const clientY=e.touches?e.touches[0].clientY:e.clientY;
    const x=clientX-rect.left;
    const index=Math.floor(x/(canvas.width/history.length));
    if(type==="speed"&&history[index]){
      const d=history[index].download; const u=history[index].upload;
      tooltip.innerHTML=`üìâ Download: ${d} Mbps<br>üìà Upload: ${u} Mbps`;
    }
    if(type==="jitter"&&jitterHistory[index]!==undefined&&lossHistory[index]!==undefined){
      const j=jitterHistory[index]; const l=lossHistory[index];
      tooltip.innerHTML=`‚ö° Jitter: ${j} ms<br>‚ùå Loss: ${l} %`;
    }
    tooltip.style.display="block"; tooltip.style.left=clientX+15+"px"; tooltip.style.top=clientY-20+"px";
  }
  function hideTooltip(){tooltip.style.display="none";}
  canvas.addEventListener("mousemove",showTooltip);
  canvas.addEventListener("mouseleave",hideTooltip);
  canvas.addEventListener("touchmove",showTooltip);
  canvas.addEventListener("touchend",hideTooltip);
}
attachTooltip(document.getElementById("speedGraph"),"speed");
attachTooltip(document.getElementById("jitterGraph"),"jitter");

// Export
function exportTXT(){let txt="Network Analyzer Report\n\n";for(const key in advancedMetrics){txt+=`${key}: ${advancedMetrics[key]}\n`;} const blob=new Blob([txt],{type:"text/plain"}); const link=document.createElement("a"); link.href=URL.createObjectURL(blob); link.download="NetworkReport.txt"; link.click();}
function exportJSON(){const blob=new Blob([JSON.stringify(advancedMetrics,null,2)],{type:"application/json"}); const link=document.createElement("a"); link.href=URL.createObjectURL(blob); link.download="NetworkReport.json"; link.click();}

// Start updates
setInterval(updateMetrics,1000);
</script>
</body>
</html>
